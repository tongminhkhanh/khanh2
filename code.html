<!DOCTYPE html>

<html class="light" lang="vi">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>Tin tức và Sự kiện - Trường Tiểu học Ít Ong</title>
    <link href="https://fonts.googleapis.com/css2?family=Lexend:wght@300;400;500;700;900&amp;display=swap"
        rel="stylesheet" />
    <link
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap"
        rel="stylesheet" />
    <link
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap"
        rel="stylesheet" />

    <!-- Resource Hints -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="dns-prefetch" href="https://res.cloudinary.com">
    <link rel="dns-prefetch" href="https://cdn.jsdelivr.net">
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries" defer></script>
    <script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#2b8cee",
                        "primary-dark": "#1a6bb8",
                        "background-light": "#f6f7f8",
                        "background-dark": "#101922",
                        "surface-light": "#ffffff",
                        "surface-dark": "#1c2a36",
                        "text-main": "#0d141b",
                        "text-secondary": "#4c739a",
                    },
                    fontFamily: {
                        "display": ["Lexend", "sans-serif"]
                    },
                    borderRadius: { "DEFAULT": "0.25rem", "lg": "0.5rem", "xl": "0.75rem", "full": "9999px" },
                },
            },
        }
    </script>
    <!-- UI Enhancements -->
    <link rel="stylesheet" href="/public/ui-enhancements.css">
</head>

<body
    class="bg-background-light dark:bg-background-dark font-display text-text-main dark:text-white antialiased flex flex-col min-h-screen overflow-x-hidden">
    <!-- Enhanced TopNavBar -->
    <header id="main-header"
        class="sticky top-0 z-50 bg-surface-light/95 dark:bg-surface-dark/95 backdrop-blur-md border-b border-[#e7edf3] dark:border-gray-700 shadow-sm transition-all duration-300">
        <div class="px-4 lg:px-10 py-3 flex items-center justify-between max-w-[1440px] mx-auto w-full transition-all duration-300"
            id="header-inner">
            <!-- Logo & Brand -->
            <div class="flex items-center gap-8">
                <a href="/" class="flex items-center gap-3 text-text-main dark:text-white group">
                    <div class="relative">
                        <img src="/public/logo_school.jpg" alt="Logo Truong Tieu hoc It Ong"
                            class="h-10 w-10 rounded-full object-cover ring-2 ring-primary/20 group-hover:ring-primary/50 transition-all duration-300"
                            loading="lazy"
                            onerror="this.onerror=null; this.src='https://ui-avatars.com/api/?name=IT+ONG&background=2b8cee&color=fff&size=40&rounded=true'">
                        <span
                            class="absolute -bottom-0.5 -right-0.5 w-3 h-3 bg-green-500 rounded-full border-2 border-white dark:border-gray-800"></span>
                    </div>
                    <div class="hidden md:block">
                        <h2
                            class="text-lg font-bold leading-tight tracking-[-0.015em] group-hover:text-primary transition-colors">
                            Trường Tiểu học Ít Ong</h2>
                        <p class="text-xs text-text-secondary dark:text-gray-400">Mường La, Sơn La</p>
                    </div>
                </a>

                <!-- Main Navigation -->
                <nav class="hidden lg:flex items-center gap-1" id="main-nav">
                    <a class="nav-link" href="/" data-page="home">
                        <span class="material-symbols-outlined nav-icon">home</span>
                        <span>Trang chủ</span>
                    </a>
                    <a class="nav-link" href="/gioi-thieu" data-page="about">
                        <span class="material-symbols-outlined nav-icon">info</span>
                        <span>Giới thiệu</span>
                    </a>
                    <a class="nav-link" href="/thong-bao" data-page="news">
                        <span class="material-symbols-outlined nav-icon">campaign</span>
                        <span>Thông báo</span>
                    </a>
                    <a class="nav-link" href="/hoat-dong" data-page="activities">
                        <span class="material-symbols-outlined nav-icon">celebration</span>
                        <span>Hoạt động</span>
                    </a>
                    <a class="nav-link" href="/thanh-tich" data-page="achievements">
                        <span class="material-symbols-outlined nav-icon">emoji_events</span>
                        <span>Thành tích</span>
                    </a>
                    <a class="nav-link" href="/su-kien" data-page="events">
                        <span class="material-symbols-outlined nav-icon">event</span>
                        <span>Sự kiện</span>
                    </a>
                    <a class="nav-link external" href="http://thitong.site" target="_blank">
                        <span class="material-symbols-outlined nav-icon">smart_toy</span>
                        <span>Trợ lý AI</span>
                        <span class="material-symbols-outlined text-xs ml-0.5">open_in_new</span>
                    </a>
                </nav>
            </div>

            <!-- Right Side: Search & Actions -->
            <div class="flex items-center gap-3">
                <!-- Search Bar -->
                <div class="hidden md:flex items-center relative group">
                    <div class="relative">
                        <input type="text" id="nav-search" placeholder="Tìm kiếm bài viết..."
                            class="text-sm pl-10 pr-4 py-2 rounded-full border-2 border-gray-200 dark:border-gray-600 bg-gray-50 dark:bg-gray-800 dark:text-white focus:outline-none focus:border-primary focus:bg-white dark:focus:bg-gray-700 w-48 focus:w-64 transition-all duration-300"
                            onkeypress="if(event.key==='Enter') searchArticles()">
                        <span
                            class="material-symbols-outlined absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 text-lg">search</span>
                    </div>
                </div>

                <!-- Mobile Search Toggle -->
                <button class="md:hidden p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors"
                    onclick="toggleMobileSearch()">
                    <span class="material-symbols-outlined text-text-main dark:text-white">search</span>
                </button>

                <!-- Admin Login Button -->
                <a href="/admin"
                    class="hidden md:flex items-center gap-2 px-4 py-2 rounded-full bg-primary/10 hover:bg-primary text-primary hover:text-white font-medium text-sm transition-all duration-300">
                    <span class="material-symbols-outlined text-lg">login</span>
                    <span>Đăng nhập</span>
                </a>

                <!-- Hamburger Menu Button (Mobile) -->
                <button
                    class="lg:hidden flex flex-col justify-center items-center w-10 h-10 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors group"
                    onclick="openMobileMenu()" id="hamburger-btn">
                    <span class="hamburger-line top"></span>
                    <span class="hamburger-line middle"></span>
                    <span class="hamburger-line bottom"></span>
                </button>
            </div>
        </div>

        <!-- Mobile Search Bar (Hidden by default) -->
        <div id="mobile-search-bar" class="hidden md:hidden px-4 pb-3">
            <div class="relative">
                <input type="text" id="nav-search-mobile" placeholder="Tìm kiếm bài viết..."
                    class="w-full text-sm pl-10 pr-4 py-2.5 rounded-xl border-2 border-gray-200 dark:border-gray-600 bg-gray-50 dark:bg-gray-800 dark:text-white focus:outline-none focus:border-primary"
                    onkeypress="if(event.key==='Enter') searchArticles()">
                <span
                    class="material-symbols-outlined absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 text-lg">search</span>
            </div>
        </div>
    </header>

    <style>
        /* Navigation Link Styles */
        .nav-link {
            display: flex;
            align-items: center;
            gap: 0.375rem;
            padding: 0.5rem 0.875rem;
            border-radius: 9999px;
            font-size: 0.875rem;
            font-weight: 500;
            color: #4c739a;
            transition: all 0.2s ease;
            position: relative;
        }

        .dark .nav-link {
            color: #9ca3af;
        }

        .nav-link:hover {
            background: rgba(43, 140, 238, 0.1);
            color: #2b8cee;
        }

        .nav-link.active {
            background: linear-gradient(135deg, #2b8cee 0%, #1a6bb8 100%);
            color: white;
            box-shadow: 0 4px 12px rgba(43, 140, 238, 0.3);
        }

        .nav-link .nav-icon {
            font-size: 18px;
            transition: transform 0.2s ease;
        }

        .nav-link:hover .nav-icon {
            transform: scale(1.1);
        }

        .nav-link.external {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(118, 75, 162, 0.1) 100%);
        }

        .nav-link.external:hover {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.2) 0%, rgba(118, 75, 162, 0.2) 100%);
            color: #764ba2;
        }

        /* Hamburger Menu Animation */
        .hamburger-line {
            width: 20px;
            height: 2px;
            background: currentColor;
            border-radius: 2px;
            transition: all 0.3s ease;
        }

        .hamburger-line.top {
            transform: translateY(-6px);
        }

        .hamburger-line.bottom {
            transform: translateY(6px);
        }

        #hamburger-btn.active .hamburger-line.top {
            transform: translateY(0) rotate(45deg);
        }

        #hamburger-btn.active .hamburger-line.middle {
            opacity: 0;
            transform: scaleX(0);
        }

        #hamburger-btn.active .hamburger-line.bottom {
            transform: translateY(0) rotate(-45deg);
        }

        /* Header Shrink on Scroll */
        #main-header.scrolled {
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }

        #main-header.scrolled #header-inner {
            padding-top: 0.5rem;
            padding-bottom: 0.5rem;
        }

        #main-header.scrolled img {
            height: 2rem;
            width: 2rem;
        }
    </style>

    <script>
        // Active Navigation State
        function setActiveNav() {
            const currentPath = window.location.pathname;
            const navLinks = document.querySelectorAll('.nav-link[data-page]');

            navLinks.forEach(link => {
                link.classList.remove('active');
                const href = link.getAttribute('href');

                if (currentPath === '/' && href === '/') {
                    link.classList.add('active');
                } else if (href !== '/' && currentPath.startsWith(href)) {
                    link.classList.add('active');
                }
            });
        }

        // Header Shrink on Scroll
        function handleHeaderScroll() {
            const header = document.getElementById('main-header');
            if (window.scrollY > 50) {
                header.classList.add('scrolled');
            } else {
                header.classList.remove('scrolled');
            }
        }

        // Toggle Mobile Search
        function toggleMobileSearch() {
            const searchBar = document.getElementById('mobile-search-bar');
            searchBar.classList.toggle('hidden');
            if (!searchBar.classList.contains('hidden')) {
                document.getElementById('nav-search-mobile').focus();
            }
        }

        // Initialize on load
        document.addEventListener('DOMContentLoaded', () => {
            setActiveNav();
            window.addEventListener('scroll', handleHeaderScroll);
        });
    </script>
    <!-- Urgent Notice Bar -->
    <div id="urgent-notice-container" class="hidden w-full py-2">
        <div class="max-w-[1200px] mx-auto px-4">
            <div
                class="bg-gradient-to-r from-red-600 to-red-500 text-white py-2.5 px-6 rounded-xl flex items-center justify-center gap-3 flex-wrap shadow-md">
                <span class="material-symbols-outlined text-xl animate-pulse">warning</span>
                <p id="urgent-notice-content" class="text-sm font-medium text-center"></p>
                <a id="urgent-notice-link" href="#"
                    class="hidden bg-white text-red-600 px-4 py-1 rounded-full text-sm font-bold hover:bg-red-100 transition-colors whitespace-nowrap">Xem
                    thêm</a>
            </div>
        </div>
    </div>
    <!-- Image Slider Banner -->
    <div id="image-slider-container"
        class="w-full bg-gradient-to-r from-blue-50 to-purple-50 dark:from-gray-900 dark:to-gray-800 py-4 overflow-hidden">
        <div class="max-w-[1200px] mx-auto px-4">
            <div class="relative overflow-hidden rounded-xl">
                <div id="image-slider" class="flex gap-4">
                    <!-- Skeleton loading for slider -->
                    <div class="h-40 w-72 bg-gray-200 dark:bg-gray-700 rounded-xl flex-shrink-0 skeleton-shimmer"></div>
                    <div class="h-40 w-72 bg-gray-200 dark:bg-gray-700 rounded-xl flex-shrink-0 skeleton-shimmer"></div>
                    <div class="h-40 w-72 bg-gray-200 dark:bg-gray-700 rounded-xl flex-shrink-0 skeleton-shimmer"></div>
                    <div class="h-40 w-72 bg-gray-200 dark:bg-gray-700 rounded-xl flex-shrink-0 skeleton-shimmer"></div>
                </div>
            </div>
        </div>
    </div>
    <style>
        /* Skeleton Loading Animation */
        @keyframes shimmer {
            0% {
                background-position: -200% 0;
            }

            100% {
                background-position: 200% 0;
            }
        }

        .skeleton-shimmer {
            background: linear-gradient(90deg,
                    rgba(200, 200, 200, 0.2) 25%,
                    rgba(200, 200, 200, 0.5) 50%,
                    rgba(200, 200, 200, 0.2) 75%);
            background-size: 200% 100%;
            animation: shimmer 1.5s ease-in-out infinite;
        }

        .dark .skeleton-shimmer {
            background: linear-gradient(90deg,
                    rgba(100, 100, 100, 0.2) 25%,
                    rgba(100, 100, 100, 0.5) 50%,
                    rgba(100, 100, 100, 0.2) 75%);
            background-size: 200% 100%;
        }

        /* Fade-in animation for loaded content */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .fade-in {
            animation: fadeIn 0.4s ease-out forwards;
        }

        /* Slider skeleton */
        .slider-skeleton {
            display: flex;
            gap: 16px;
            padding: 0 16px;
        }

        .slider-skeleton-item {
            height: 160px;
            width: 280px;
            flex-shrink: 0;
            border-radius: 12px;
        }

        #image-slider-container {
            min-height: 180px;
        }

        #image-slider {
            display: flex;
            gap: 16px;
        }

        #image-slider img {
            height: 160px;
            width: 280px;
            object-fit: cover;
            flex-shrink: 0;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        #image-slider img:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
        }

        @keyframes scroll-left {
            0% {
                transform: translateX(0);
            }

            100% {
                transform: translateX(-50%);
            }
        }

        .slider-animate {
            animation: scroll-left 30s linear infinite;
        }

        #image-slider-container:hover .slider-animate {
            animation-play-state: paused;
        }

        /* Hide load-more button while loading */
        #load-more-btn.loading-hidden {
            display: none !important;
        }

        /* ===== PAGE TRANSITIONS ===== */
        /* Fade-in effect when page loads */
        body {
            opacity: 0;
            animation: pageLoad 0.6s ease-out forwards;
        }

        @keyframes pageLoad {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Smooth page exit transition */
        body.page-exit {
            animation: pageExit 0.3s ease-in forwards;
        }

        @keyframes pageExit {
            from {
                opacity: 1;
                transform: translateY(0);
            }

            to {
                opacity: 0;
                transform: translateY(-10px);
            }
        }

        /* ===== ENHANCED BUTTON HOVER EFFECTS ===== */
        /* Primary buttons with gradient and lift effect */
        .btn-enhanced {
            position: relative;
            overflow: hidden;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .btn-enhanced::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s;
        }

        .btn-enhanced:hover::before {
            left: 100%;
        }

        .btn-enhanced:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(43, 140, 238, 0.35);
        }

        /* Newsletter button enhanced */
        #newsletter-form button {
            position: relative;
            overflow: hidden;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        #newsletter-form button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.5s;
        }

        #newsletter-form button:hover::before {
            left: 100%;
        }

        #newsletter-form button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(43, 140, 238, 0.4);
        }

        /* Load more button enhanced */
        #load-more-btn {
            position: relative;
            overflow: hidden;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        #load-more-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
            border-color: var(--primary, #2b8cee);
            color: var(--primary, #2b8cee);
        }

        /* ===== ENHANCED ARTICLE CARD HOVER EFFECTS ===== */
        /* Article cards with lift and glow effect */
        #news-grid article:not(.skeleton-card) {
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        #news-grid article:not(.skeleton-card):hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 40px rgba(43, 140, 238, 0.15), 0 8px 16px rgba(0, 0, 0, 0.08);
        }

        #news-grid article:not(.skeleton-card):hover img {
            transform: scale(1.1);
        }

        /* Category tag bounce on card hover */
        #news-grid article:not(.skeleton-card):hover span.bg-blue-100 {
            animation: tagBounce 0.5s ease;
        }

        @keyframes tagBounce {

            0%,
            100% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.1);
            }
        }

        /* Featured section enhanced hover */
        #featured-main:hover img {
            transform: scale(1.08);
        }

        #featured-side-list>div {
            transition: all 0.3s ease;
            padding: 0.5rem;
            border-radius: 0.5rem;
        }

        #featured-side-list>div:hover {
            background: rgba(43, 140, 238, 0.05);
            transform: translateX(4px);
        }

        /* Sidebar widget cards hover */
        aside>div {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        aside>div:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
        }

        /* Quick links enhanced hover */
        .flex.items-center.gap-2.text-sm.text-text-secondary {
            transition: all 0.2s ease;
            padding: 0.25rem 0.5rem;
            margin: -0.25rem -0.5rem;
            border-radius: 0.375rem;
        }

        .flex.items-center.gap-2.text-sm.text-text-secondary:hover {
            background: rgba(43, 140, 238, 0.08);
            transform: translateX(4px);
        }

        /* ===== BACK TO TOP BUTTON ===== */
        #back-to-top {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, #2b8cee 0%, #1a6bb8 100%);
            color: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 999;
            opacity: 0;
            visibility: hidden;
            transform: translateY(20px) scale(0.8);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 15px rgba(43, 140, 238, 0.4);
        }

        #back-to-top.visible {
            opacity: 1;
            visibility: visible;
            transform: translateY(0) scale(1);
        }

        #back-to-top:hover {
            transform: translateY(-4px) scale(1.1);
            box-shadow: 0 8px 25px rgba(43, 140, 238, 0.5);
        }

        #back-to-top:active {
            transform: translateY(-2px) scale(1.05);
        }

        #back-to-top .material-symbols-outlined {
            font-size: 24px;
            transition: transform 0.3s ease;
        }

        #back-to-top:hover .material-symbols-outlined {
            animation: arrowBounce 0.6s ease infinite;
        }

        @keyframes arrowBounce {

            0%,
            100% {
                transform: translateY(0);
            }

            50% {
                transform: translateY(-3px);
            }
        }

        /* ===== NAV LINK HOVER ENHANCEMENT ===== */
        header nav a {
            position: relative;
            transition: all 0.3s ease;
        }

        header nav a::after {
            content: '';
            position: absolute;
            bottom: -4px;
            left: 0;
            width: 0;
            height: 2px;
            background: linear-gradient(90deg, #2b8cee, #1a6bb8);
            border-radius: 1px;
            transition: width 0.3s ease;
        }

        header nav a:hover::after {
            width: 100%;
        }

        /* ===== FOOTER LINK HOVER ===== */
        footer a {
            transition: all 0.2s ease;
        }

        footer a:hover {
            color: #2b8cee;
            transform: translateX(2px);
        }

        /* ===== EVENTS LIST ITEM HOVER ===== */
        #upcoming-events-list>div {
            transition: all 0.3s ease;
            padding: 0.5rem;
            border-radius: 0.5rem;
            margin: -0.5rem;
        }

        #upcoming-events-list>div:hover {
            background: rgba(43, 140, 238, 0.05);
            transform: translateX(4px);
        }

        /* ===== SMOOTH SCROLL BEHAVIOR ===== */
        html {
            scroll-behavior: smooth;
        }
    </style>
    <script>
        // Load images for slider
        async function loadSliderImages() {
            try {
                let images = [];
                // Try load from settings first
                const resS = await fetch('/api/settings/slider_images');
                if (resS.ok) {
                    const s = await resS.json();
                    if (s.value && s.value.images && s.value.images.length > 0) images = s.value.images;
                }
                // Fallback to all media
                if (images.length === 0) {
                    const resM = await fetch('/api/public/media');
                    const media = await resM.json();
                    images = media.map(m => m.path);
                }
                const slider = document.getElementById('image-slider');
                if (images.length > 0) {
                    let html = '';
                    images.forEach(p => {
                        html += `<img src="${p}" alt="Slider" onerror="this.style.display='none'" loading="lazy">`;
                    });
                    slider.innerHTML = html + html;
                    slider.classList.add('slider-animate');
                    // Check if any images loaded successfully
                    setTimeout(() => {
                        const visibleImages = slider.querySelectorAll('img:not([style*="display: none"])');
                        if (visibleImages.length === 0) {
                            document.getElementById('image-slider-container').classList.add('hidden');
                        }
                    }, 2000);
                } else {
                    document.getElementById('image-slider-container').classList.add('hidden');
                }
            } catch (err) {
                console.error('Error loading slider:', err);
                document.getElementById('image-slider-container').classList.add('hidden');
            }
        }
        loadSliderImages();
    </script>
    <!-- Main Content -->
    <main class="flex-1 w-full max-w-[1200px] mx-auto px-4 py-8 flex flex-col gap-10">
        <!-- Hero Section -->
        <section id="featured-section"
            class="hidden flex flex-col lg:flex-row gap-6 lg:gap-10 items-stretch bg-surface-light dark:bg-surface-dark rounded-xl p-4 lg:p-6 shadow-sm border border-[#cfdbe7] dark:border-gray-800">
            <!-- Main Featured Article -->
            <div id="featured-main"
                class="w-full lg:w-3/5 relative group cursor-pointer overflow-hidden rounded-lg aspect-video lg:aspect-auto min-h-[300px]"
                onclick="">
                <img id="featured-main-bg" src="" alt="Featured Article"
                    class="absolute inset-0 w-full h-full object-cover transition-transform duration-700 group-hover:scale-105"
                    loading="lazy">
                <div class="absolute inset-0 bg-gradient-to-t from-black/80 via-transparent to-transparent"></div>
                <div class="absolute bottom-0 left-0 p-6 flex flex-col gap-2">
                    <span id="featured-main-category"
                        class="inline-flex items-center justify-center px-3 py-1 rounded-full bg-primary text-white text-xs font-bold w-fit mb-2">
                        Tiêu điểm
                    </span>
                    <h1 id="featured-main-title"
                        class="text-white text-2xl lg:text-3xl font-bold leading-tight drop-shadow-md">
                        <!-- Title -->
                    </h1>
                </div>
            </div>
            <!-- Side Featured Articles -->
            <div class="w-full lg:w-2/5 flex flex-col justify-center gap-6">
                <div>
                    <h2 id="principal-message-title" class="text-text-main dark:text-white text-xl font-bold mb-3">
                        Thông
                        điệp từ Hiệu Trưởng</h2>
                    <p id="principal-message-content"
                        class="text-text-secondary dark:text-gray-400 text-base leading-relaxed">
                        Hân hoan chào đón các em học sinh bước vào năm học mới với nhiều niềm vui và hứng khởi. Cùng
                        nhìn lại những khoảnh khắc đáng nhớ trong ngày hội đến trường, nơi ươm mầm những ước mơ
                        xanh.
                    </p>
                </div>
                <div id="featured-side-list"
                    class="flex flex-col gap-4 border-t border-gray-100 dark:border-gray-700 pt-6">
                    <!-- Side items injected here -->
                </div>
                <button onclick="window.location.href='/thong-bao'"
                    class="mt-2 w-fit flex items-center gap-2 text-primary font-bold hover:text-primary-dark transition-colors group">
                    Xem tất cả tiêu điểm
                    <span
                        class="material-symbols-outlined text-base group-hover:translate-x-1 transition-transform">arrow_forward</span>
                </button>
            </div>
        </section>

        <div class="grid grid-cols-1 lg:grid-cols-12 gap-8">
            <!-- Left Column: News Grid (8 cols) -->
            <div class="lg:col-span-8 flex flex-col gap-8">
                <h3 class="text-xl font-bold text-text-main dark:text-white flex items-center gap-2">
                    <span class="w-1 h-6 bg-primary rounded-full"></span>
                    Tin mới nhất
                </h3>
                <div id="news-grid" class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- Skeleton Loading Cards - will be replaced by API data -->
                    <article
                        class="skeleton-card flex flex-col bg-surface-light dark:bg-surface-dark rounded-xl overflow-hidden border border-[#cfdbe7] dark:border-gray-800 animate-pulse">
                        <div class="relative h-48 bg-gray-200 dark:bg-gray-700"></div>
                        <div class="p-5 flex flex-col flex-1">
                            <div class="h-3 bg-gray-200 dark:bg-gray-700 rounded w-20 mb-3"></div>
                            <div class="h-5 bg-gray-200 dark:bg-gray-700 rounded w-full mb-2"></div>
                            <div class="h-5 bg-gray-200 dark:bg-gray-700 rounded w-3/4 mb-4"></div>
                            <div class="h-3 bg-gray-200 dark:bg-gray-700 rounded w-full mb-2"></div>
                            <div class="h-3 bg-gray-200 dark:bg-gray-700 rounded w-2/3 mb-4"></div>
                            <div class="h-4 bg-gray-200 dark:bg-gray-700 rounded w-24"></div>
                        </div>
                    </article>
                    <article
                        class="skeleton-card flex flex-col bg-surface-light dark:bg-surface-dark rounded-xl overflow-hidden border border-[#cfdbe7] dark:border-gray-800 animate-pulse">
                        <div class="relative h-48 bg-gray-200 dark:bg-gray-700"></div>
                        <div class="p-5 flex flex-col flex-1">
                            <div class="h-3 bg-gray-200 dark:bg-gray-700 rounded w-20 mb-3"></div>
                            <div class="h-5 bg-gray-200 dark:bg-gray-700 rounded w-full mb-2"></div>
                            <div class="h-5 bg-gray-200 dark:bg-gray-700 rounded w-3/4 mb-4"></div>
                            <div class="h-3 bg-gray-200 dark:bg-gray-700 rounded w-full mb-2"></div>
                            <div class="h-3 bg-gray-200 dark:bg-gray-700 rounded w-2/3 mb-4"></div>
                            <div class="h-4 bg-gray-200 dark:bg-gray-700 rounded w-24"></div>
                        </div>
                    </article>
                    <article
                        class="skeleton-card flex flex-col bg-surface-light dark:bg-surface-dark rounded-xl overflow-hidden border border-[#cfdbe7] dark:border-gray-800 animate-pulse">
                        <div class="relative h-48 bg-gray-200 dark:bg-gray-700"></div>
                        <div class="p-5 flex flex-col flex-1">
                            <div class="h-3 bg-gray-200 dark:bg-gray-700 rounded w-20 mb-3"></div>
                            <div class="h-5 bg-gray-200 dark:bg-gray-700 rounded w-full mb-2"></div>
                            <div class="h-5 bg-gray-200 dark:bg-gray-700 rounded w-3/4 mb-4"></div>
                            <div class="h-3 bg-gray-200 dark:bg-gray-700 rounded w-full mb-2"></div>
                            <div class="h-3 bg-gray-200 dark:bg-gray-700 rounded w-2/3 mb-4"></div>
                            <div class="h-4 bg-gray-200 dark:bg-gray-700 rounded w-24"></div>
                        </div>
                    </article>
                    <article
                        class="skeleton-card flex flex-col bg-surface-light dark:bg-surface-dark rounded-xl overflow-hidden border border-[#cfdbe7] dark:border-gray-800 animate-pulse">
                        <div class="relative h-48 bg-gray-200 dark:bg-gray-700"></div>
                        <div class="p-5 flex flex-col flex-1">
                            <div class="h-3 bg-gray-200 dark:bg-gray-700 rounded w-20 mb-3"></div>
                            <div class="h-5 bg-gray-200 dark:bg-gray-700 rounded w-full mb-2"></div>
                            <div class="h-5 bg-gray-200 dark:bg-gray-700 rounded w-3/4 mb-4"></div>
                            <div class="h-3 bg-gray-200 dark:bg-gray-700 rounded w-full mb-2"></div>
                            <div class="h-3 bg-gray-200 dark:bg-gray-700 rounded w-2/3 mb-4"></div>
                            <div class="h-4 bg-gray-200 dark:bg-gray-700 rounded w-24"></div>
                        </div>
                    </article>
                </div>
                <div class="flex justify-center mt-4">
                    <button id="load-more-btn" onclick="loadMoreArticles()"
                        class="px-6 py-2 border border-[#cfdbe7] dark:border-gray-700 rounded-lg text-text-secondary dark:text-gray-300 font-medium hover:bg-white dark:hover:bg-gray-800 transition-colors">
                        Xem thêm tin cũ hơn
                    </button>
                </div>
            </div>
            <!-- Right Column: Sidebar (4 cols) -->
            <aside class="lg:col-span-4 flex flex-col gap-8">
                <!-- Upcoming Events Widget -->
                <div
                    class="bg-surface-light dark:bg-surface-dark rounded-xl p-5 border border-[#cfdbe7] dark:border-gray-800 shadow-sm">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-lg font-bold text-text-main dark:text-white">Sự kiện sắp tới</h3>
                        <a class="text-xs text-primary font-bold hover:underline" href="/su-kien">Xem lịch</a>
                    </div>
                    <div id="upcoming-events-list" class="flex flex-col gap-4">
                        <!-- Events will be loaded dynamically -->
                        <p class="text-sm text-text-secondary dark:text-gray-400 text-center py-4">Đang tải sự
                            kiện...
                        </p>
                    </div>
                </div>
                <script>
                    // Load upcoming events
                    async function loadUpcomingEvents() {
                        try {
                            const res = await fetch('/api/events');
                            const events = await res.json();
                            const container = document.getElementById('upcoming-events-list');

                            // Filter only future events and sort by date
                            const now = new Date();
                            const upcomingEvents = events
                                .filter(event => new Date(event.startDate) >= now && event.isPublished)
                                .sort((a, b) => new Date(a.startDate) - new Date(b.startDate))
                                .slice(0, 5); // Show only 5 upcoming events

                            if (upcomingEvents.length === 0) {
                                container.innerHTML = '<p class="text-sm text-text-secondary dark:text-gray-400 text-center py-4">Không có sự kiện sắp tới</p>';
                                return;
                            }

                            container.innerHTML = upcomingEvents.map(event => {
                                const startDate = new Date(event.startDate);
                                const endDate = new Date(event.endDate);
                                const day = startDate.getDate();
                                const month = 'T' + (startDate.getMonth() + 1);

                                // Format time
                                const startTime = startDate.toLocaleTimeString('vi-VN', { hour: '2-digit', minute: '2-digit' });
                                const endTime = endDate.toLocaleTimeString('vi-VN', { hour: '2-digit', minute: '2-digit' });

                                // Check if all day event (same time or more than 12 hours)
                                const duration = (endDate - startDate) / (1000 * 60 * 60);
                                const timeDisplay = duration >= 12 ? 'Cả ngày' : startTime + ' - ' + endTime;
                                const locationDisplay = event.location || 'Trường học';

                                return `
                                    <div class="flex gap-3 group cursor-pointer" onclick="window.location.href='/su-kien'">
                                        <div class="flex flex-col items-center justify-center bg-blue-50 dark:bg-blue-900/30 w-12 h-14 rounded-lg shrink-0 border border-blue-100 dark:border-blue-800">
                                            <span class="text-xs text-primary font-bold uppercase pt-1">${month}</span>
                                            <span class="text-lg font-black text-text-main dark:text-white leading-none pb-1">${day}</span>
                                        </div>
                                        <div>
                                            <h4 class="text-sm font-bold text-text-main dark:text-white group-hover:text-primary transition-colors">
                                                ${event.title}
                                            </h4>
                                            <p class="text-xs text-text-secondary dark:text-gray-400 mt-1">${timeDisplay} | ${locationDisplay}</p>
                                        </div>
                                    </div>
                                `;
                            }).join('');
                        } catch (err) {
                            console.error('Error loading events:', err);
                            document.getElementById('upcoming-events-list').innerHTML =
                                '<p class="text-sm text-text-secondary dark:text-gray-400 text-center py-4">Không thể tải sự kiện</p>';
                        }
                    }
                    loadUpcomingEvents();
                </script>
                <!-- Newsletter Signup -->
                <div class="bg-primary/10 dark:bg-primary/5 rounded-xl p-6 border border-primary/20">
                    <div class="flex items-center gap-3 mb-3 text-primary">
                        <span class="material-symbols-outlined text-3xl">mark_email_unread</span>
                        <h3 class="text-lg font-bold text-text-main dark:text-white">Đăng ký bản tin</h3>
                    </div>
                    <p class="text-sm text-text-secondary dark:text-gray-300 mb-4">
                        Nhận thông báo mới nhất về hoạt động và sự kiện của trường qua email hàng tuần.
                    </p>
                    <form class="flex flex-col gap-3" id="newsletter-form">
                        <input
                            class="w-full h-10 px-3 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-sm focus:ring-2 focus:ring-primary focus:border-transparent outline-none"
                            id="newsletter-email" placeholder="Email của phụ huynh" type="email" required />
                        <button
                            class="w-full h-10 bg-primary hover:bg-primary-dark text-white text-sm font-bold rounded-lg transition-colors shadow-sm"
                            type="submit">
                            Đăng ký ngay
                        </button>
                    </form>
                    <script>
                        document.getElementById('newsletter-form').addEventListener('submit', async (e) => {
                            e.preventDefault();
                            const email = document.getElementById('newsletter-email').value;

                            try {
                                const response = await fetch('/api/subscribe', {
                                    method: 'POST',
                                    headers: {
                                        'Content-Type': 'application/json'
                                    },
                                    body: JSON.stringify({ email })
                                });

                                const data = await response.json();

                                if (data.success) {
                                    alert(data.message);
                                    document.getElementById('newsletter-email').value = '';
                                } else {
                                    alert('Có lỗi xảy ra: ' + data.message);
                                }
                            } catch (error) {
                                console.error('Error:', error);
                                alert('Có lỗi xảy ra khi đăng ký.');
                            }
                        });
                    </script>
                </div>
                <!-- Quick Links -->
                <div
                    class="bg-surface-light dark:bg-surface-dark rounded-xl p-5 border border-[#cfdbe7] dark:border-gray-800 shadow-sm">
                    <h3 class="text-lg font-bold text-text-main dark:text-white mb-4">Liên kết nhanh</h3>
                    <ul class="flex flex-col gap-2">
                        <li>
                            <a class="flex items-center gap-2 text-sm text-text-secondary dark:text-gray-300 hover:text-primary transition-colors"
                                href="#">
                                <span class="material-symbols-outlined text-base">chevron_right</span>
                                Thời khóa biểu
                            </a>
                        </li>
                        <li>
                            <a class="flex items-center gap-2 text-sm text-text-secondary dark:text-gray-300 hover:text-primary transition-colors"
                                href="#">
                                <span class="material-symbols-outlined text-base">chevron_right</span>
                                Thư viện ảnh
                            </a>
                        </li>
                        <li>
                            <a class="flex items-center gap-2 text-sm text-text-secondary dark:text-gray-300 hover:text-primary transition-colors"
                                href="#">
                                <span class="material-symbols-outlined text-base">chevron_right</span>
                                Văn bản &amp; Biểu mẫu
                            </a>
                        </li>
                    </ul>
                </div>
            </aside>
        </div>
    </main>
    <!-- Footer -->
    <footer class="bg-white dark:bg-[#151f2b] border-t border-[#e7edf3] dark:border-gray-700 mt-auto">
        <div class="max-w-[1200px] mx-auto px-4 py-10">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
                <div class="col-span-1 md:col-span-1">
                    <div class="flex items-center gap-3 mb-4">
                        <img src="/public/logo_school.jpg" alt="Logo Trường Tiểu học Ít Ong"
                            class="h-12 w-12 rounded-full object-cover ring-2 ring-primary/30"
                            onerror="this.onerror=null; this.src='https://ui-avatars.com/api/?name=IT+ONG&background=2b8cee&color=fff&size=48&rounded=true'">
                        <span class="font-bold text-lg text-text-main dark:text-white">Tiểu học Ít Ong</span>
                    </div>
                    <p class="text-sm text-text-secondary dark:text-gray-400">
                        Nơi ươm mầm tài năng và nhân cách, xây dựng nền tảng vững chắc cho tương lai.
                    </p>
                </div>
                <div>
                    <h4 class="font-bold text-text-main dark:text-white mb-4">Về Nhà Trường</h4>
                    <ul class="space-y-2 text-sm text-text-secondary dark:text-gray-400">
                        <li><a class="hover:text-primary" href="#">Lịch sử hình thành</a></li>
                        <li><a class="hover:text-primary" href="#">Đội ngũ giáo viên</a></li>
                        <li><a class="hover:text-primary" href="#">Cơ sở vật chất</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="font-bold text-text-main dark:text-white mb-4">Tuyển Sinh</h4>
                    <ul class="space-y-2 text-sm text-text-secondary dark:text-gray-400">
                        <li><a class="hover:text-primary" href="#">Thông báo tuyển sinh</a></li>
                        <li><a class="hover:text-primary" href="#">Hồ sơ nhập học</a></li>
                        <li><a class="hover:text-primary" href="#">Học phí &amp; Chính sách</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="font-bold text-text-main dark:text-white mb-4">Liên Hệ</h4>
                    <ul class="space-y-2 text-sm text-text-secondary dark:text-gray-400">
                        <li class="flex items-start gap-2">
                            <span class="material-symbols-outlined text-base mt-0.5">location_on</span>
                            Tiểu khu 1, xã Mường La, tỉnh Sơn La
                        </li>
                        <li class="flex items-center gap-2">
                            <span class="material-symbols-outlined text-base">call</span>
                            (84) 326 439774
                        </li>
                        <li class="flex items-center gap-2">
                            <span class="material-symbols-outlined text-base">mail</span>
                            khanhtm.muongla@sonla.gov.vn
                        </li>
                    </ul>
                </div>
            </div>
            <div
                class="border-t border-[#e7edf3] dark:border-gray-700 mt-10 pt-6 flex flex-col md:flex-row justify-between items-center gap-4">
                <p class="text-xs text-text-secondary dark:text-gray-500">© 2023 Trường Tiểu học Ít Ong. All rights
                    reserved.</p>
                <div class="flex gap-4">
                    <a class="text-text-secondary dark:text-gray-400 hover:text-primary" href="#"><span
                            class="material-symbols-outlined">public</span></a>
                </div>
            </div>
        </div>
    </footer>
    <script>
        document.addEventListener('DOMContentLoaded', async () => {
            const newsGrid = document.getElementById('news-grid');

            // Fetch Urgent Notice
            try {
                const response = await fetch('/api/settings/urgent_notice');
                if (response.ok) {
                    const setting = await response.json();
                    const data = setting.value || {};

                    if (data.isEnabled) {
                        document.getElementById('urgent-notice-container').classList.remove('hidden');
                        document.getElementById('urgent-notice-content').innerText = data.content;

                        if (data.link) {
                            const linkBtn = document.getElementById('urgent-notice-link');
                            linkBtn.classList.remove('hidden');
                            linkBtn.onclick = () => window.location.href = data.link;
                        }
                    }
                }
            } catch (error) {
                console.error('Error fetching urgent notice:', error);
            }

            // Fetch Principal Message
            try {
                const response = await fetch('/api/settings/principal_message');
                if (response.ok) {
                    const setting = await response.json();
                    const data = setting.value || {};
                    if (data.title) document.getElementById('principal-message-title').innerText = data.title;
                    if (data.content) document.getElementById('principal-message-content').innerText = data.content;
                }
            } catch (error) {
                console.error('Error fetching principal message:', error);
            }

            try {
                const response = await fetch('/api/articles');
                const articles = await response.json();

                if (articles.length > 0) {
                    // Populate Featured Section
                    const featuredSection = document.getElementById('featured-section');
                    const mainArticle = articles[0];
                    const sideArticles = articles.slice(1, 3);

                    if (mainArticle) {
                        featuredSection.classList.remove('hidden');
                        document.getElementById('featured-main').onclick = () => window.location.href = `/bai-viet/${mainArticle._id}`;
                        document.getElementById('featured-main-bg').src = mainArticle.image || 'https://via.placeholder.com/800x400';
                        document.getElementById('featured-main-title').innerText = mainArticle.title;
                        document.getElementById('featured-main-category').innerText = mainArticle.category || 'Tiêu điểm';
                    }

                    const sideList = document.getElementById('featured-side-list');
                    sideList.innerHTML = '';
                    sideArticles.forEach(article => {
                        const html = `
                            <div class="flex items-center gap-3 group cursor-pointer" onclick="window.location.href='/bai-viet/${article._id}'">
                                <img src="${article.image || 'https://via.placeholder.com/100x100'}" alt="${article.title}" class="w-20 h-14 rounded-md object-cover shrink-0" loading="lazy">
                                <div>
                                    <p class="text-xs text-primary font-semibold mb-1">${article.category || 'Tin tức'}</p>
                                    <h3 class="text-sm font-bold text-text-main dark:text-white group-hover:text-primary transition-colors line-clamp-2">
                                        ${article.title}
                                    </h3>
                                </div>
                            </div>
                        `;
                        sideList.innerHTML += html;
                    });

                    // Populate Grid (skip first 3 if you want distinct featured, or show all)
                    // Showing all in grid for now as per usual news site pattern or skipping featured?
                    // Let's skip the main one at least to avoid duplication if desired, but user didn't specify.
                    // I'll display ALL in grid for completeness, or maybe slice(3). 
                    // Let's display ALL in grid for now to ensure nothing is hidden, 
                    // or maybe slice(0) is fine.

                    newsGrid.innerHTML = ''; // Clear skeleton content
                    let articlesToShow = articles.slice(0, 4); // Show only 4 initially
                    window.allArticles = articles; // Store all articles
                    window.currentArticleIndex = 4;

                    articlesToShow.forEach((article, index) => {
                        const date = new Date(article.createdAt).toLocaleDateString('vi-VN');
                        const imageUrl = article.image || 'https://via.placeholder.com/400x200?text=No+Image';

                        const articleHtml = `
                            <article class="flex flex-col bg-surface-light dark:bg-surface-dark rounded-xl overflow-hidden border border-[#cfdbe7] dark:border-gray-800 hover:shadow-lg transition-shadow duration-300 group fade-in" style="animation-delay: ${index * 0.1}s">
                                <div class="relative h-48 overflow-hidden">
                                    <img src="${imageUrl}" alt="${article.title}" class="absolute inset-0 w-full h-full object-cover transition-transform duration-500 group-hover:scale-110" loading="lazy">
                                    <span class="absolute top-3 left-3 bg-blue-100 text-blue-800 text-xs font-bold px-2 py-1 rounded border border-blue-200">
                                        ${article.category || 'Tin tức'}
                                    </span>
                                </div>
                                <div class="p-5 flex flex-col flex-1">
                                    <div class="text-xs text-gray-500 mb-2 flex items-center gap-1">
                                        <span class="material-symbols-outlined text-[16px]">calendar_today</span>
                                        ${date}
                                    </div>
                                    <h3 class="text-lg font-bold text-text-main dark:text-white mb-2 leading-tight group-hover:text-primary transition-colors">
                                        <a href="/bai-viet/${article._id}">${article.title}</a>
                                    </h3>
                                    <div class="text-text-secondary dark:text-gray-400 text-sm line-clamp-3 mb-4 flex-1">
                                        ${article.content} 
                                    </div>
                                    <a class="inline-flex items-center text-primary text-sm font-bold hover:underline" href="/bai-viet/${article._id}">
                                        Xem chi tiết
                                    </a>
                                </div>
                            </article>
                        `;
                        newsGrid.innerHTML += articleHtml;
                    });

                    // Hide load more button if no more articles
                    if (articles.length <= 4) {
                        document.getElementById('load-more-btn').style.display = 'none';
                    } else {
                        document.getElementById('load-more-btn').classList.remove('loading-hidden');
                    }
                } else {
                    // No articles - show empty state
                    newsGrid.innerHTML = `
                        <div class="col-span-2 text-center py-12 fade-in">
                            <span class="material-symbols-outlined text-6xl text-gray-300 dark:text-gray-600 mb-4">article</span>
                            <p class="text-text-secondary dark:text-gray-400">Chưa có bài viết nào.</p>
                        </div>
                    `;
                    document.getElementById('load-more-btn').style.display = 'none';
                }
            } catch (error) {
                console.error('Error fetching articles:', error);
                // Show error message to user
                const newsGrid = document.getElementById('news-grid');
                newsGrid.innerHTML = `
                    <div class="col-span-2 text-center py-12 fade-in">
                        <span class="material-symbols-outlined text-6xl text-red-300 dark:text-red-600 mb-4">cloud_off</span>
                        <p class="text-text-secondary dark:text-gray-400 mb-2">Không thể tải bài viết.</p>
                        <button onclick="location.reload()" class="text-primary hover:underline text-sm font-medium">
                            <span class="material-symbols-outlined text-sm align-middle">refresh</span>
                            Thử lại
                        </button>
                    </div>
                `;
                document.getElementById('load-more-btn').style.display = 'none';
            }
        });

        // Load more articles function
        function loadMoreArticles() {
            const newsGrid = document.getElementById('news-grid');
            const articles = window.allArticles || [];
            const start = window.currentArticleIndex || 4;
            const end = start + 4;
            const moreArticles = articles.slice(start, end);

            moreArticles.forEach(article => {
                const date = new Date(article.createdAt).toLocaleDateString('vi-VN');
                const imageUrl = article.image || 'https://via.placeholder.com/400x200?text=No+Image';
                const articleHtml = `
                    <article class="flex flex-col bg-surface-light dark:bg-surface-dark rounded-xl overflow-hidden border border-[#cfdbe7] dark:border-gray-800 hover:shadow-lg transition-shadow duration-300 group">
                        <div class="relative h-48 overflow-hidden">
                            <img src="${imageUrl}" alt="${article.title}" class="absolute inset-0 w-full h-full object-cover transition-transform duration-500 group-hover:scale-110" loading="lazy">
                            <span class="absolute top-3 left-3 bg-blue-100 text-blue-800 text-xs font-bold px-2 py-1 rounded border border-blue-200">
                                ${article.category || 'Tin tức'}
                            </span>
                        </div>
                        <div class="p-5 flex flex-col flex-1">
                            <div class="text-xs text-gray-500 mb-2 flex items-center gap-1">
                                <span class="material-symbols-outlined text-[16px]">calendar_today</span>
                                ${date}
                            </div>
                            <h3 class="text-lg font-bold text-text-main dark:text-white mb-2 leading-tight group-hover:text-primary transition-colors">
                                <a href="/bai-viet/${article._id}">${article.title}</a>
                            </h3>
                            <div class="text-text-secondary dark:text-gray-400 text-sm line-clamp-3 mb-4 flex-1">
                                ${article.content} 
                            </div>
                            <a class="inline-flex items-center text-primary text-sm font-bold hover:underline" href="/bai-viet/${article._id}">
                                Xem chi tiết
                            </a>
                        </div>
                    </article>
                `;
                newsGrid.innerHTML += articleHtml;
            });

            window.currentArticleIndex = end;

            // Hide button if no more articles
            if (end >= articles.length) {
                document.getElementById('load-more-btn').style.display = 'none';
            }
        }

        // Search function
        function searchArticles() {
            const query = document.getElementById('nav-search').value.trim();
            if (query) {
                window.location.href = '/search?q=' + encodeURIComponent(query);
            }
        }

        // ===== BACK TO TOP BUTTON FUNCTIONALITY =====
        const backToTopBtn = document.getElementById('back-to-top');

        // Show/hide button based on scroll position
        window.addEventListener('scroll', () => {
            if (window.scrollY > 400) {
                backToTopBtn.classList.add('visible');
            } else {
                backToTopBtn.classList.remove('visible');
            }
        });

        // Smooth scroll to top
        function scrollToTop() {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        }

        // ===== PAGE TRANSITION HANDLING =====
        // Add smooth transition when navigating to internal links
        document.querySelectorAll('a[href^="/"], a[href^="./"]').forEach(link => {
            link.addEventListener('click', function (e) {
                const href = this.getAttribute('href');
                // Skip external links and anchor links
                if (href.startsWith('http') || href.startsWith('#') || href.startsWith('javascript:')) return;

                e.preventDefault();
                document.body.classList.add('page-exit');

                setTimeout(() => {
                    window.location.href = href;
                }, 300);
            });
        });
    </script>

    <!-- Back to Top Button -->
    <button id="back-to-top" onclick="scrollToTop()" aria-label="Về đầu trang" title="Về đầu trang">
        <span class="material-symbols-outlined">arrow_upward</span>
    </button>

    <!-- UI Enhancements Script -->
    <script src="/public/ui-enhancements.js"></script>

</body>

</html>